{% extends 'base.html'%}

{% block title %} Criar Estudante(s) {% endblock %}

{% block content %}
<script>
	$(document).ready(function() {
		$('.container').removeClass('container');
	});
	setGenPasswordToFields(['id_{{form.password1.name}}', 'id_{{form.password2.name}}'])
</script>


<div class="content">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-9">
				<div class="card w-50">
					<div class="card-header">
						<h4 class="card-title">Criar Estudante(s)</h4>
					</div>
					<div class="card-body">
						<div class="row">
							<div class="col-md-11 pr-1">
								<div class="form-group">
									<form method="POST" enctype="multipart/form-data" class=""> {% csrf_token %}

										<div class="labelandform">
											<select class="form-control" id="select_form">
												<option id="" value="" selected>Você deseja selecionar estudantes existentes?</option>
												<option value="sim">Sim</option>
												<option value="não">Não</option>
											</select>
										</div>
										<input type="hidden" name="sim/não" id="sim/não" value="não">
										<input type="hidden" name="import/noimport" id="import/noimport" value="não">
										<div id="pai">
										</div>
										<div id="child"></div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$('#pai').children('div').remove();
		$('#select_form').on('change',function(){
			setGenPasswordToFields(['id_{{form.password1.name}}', 'id_{{form.password2.name}}'])
			var selectValor = $(this).val();
			if (selectValor == '') {
				$('#pai').children('div').remove();
			}
			else if(selectValor == 'sim'){
				$('#pai').children('#não').remove();
				$('#child').children('div').remove();
				$('#pai').append('<div id="sim"><p><button class="btn btn-info btn-fill pull-left" type="submit" style="background-color: #213f99; border-color: #213f99; margin-top: 10px;">Próximo</button></p></div>');
				document.getElementById('sim/não').value = 'sim'
			}
			else if(selectValor == 'não'){
				$('#pai').children('#sim').remove();
				$('#pai').append('<div id="não"><select class="form-control" id="select_form" onchange="selectUser(this)"><option id="" value="" selected>Você deseja importar por CSV ou adicionar apenas um?</option><option value="sim">Importar</option><option value="não">Adicionar apenas um</option></select>')
				document.getElementById('sim/não').value = 'não'
				$(".chosen-select").chosen({ no_results_text: "Oops, nothing found!" });
			}
			$('#pai').children('div').hide();
			$('#pai').children('#'+selectValor).show();
		});
	});
	function selectUser(ele){
		setGenPasswordToFields(['id_{{form.password1.name}}', 'id_{{form.password2.name}}'])
		var selectValor = $(ele).val();
		if (selectValor == ''){
			$('#child').children('div').remove()
		}
		if (selectValor == 'não') {
			$('#child').children('#sim').remove();
			$('#child').append('<div id="não"><p><div class="form-group"><label>Nome: </label><div class="">{{ form.first_name }}</div></div><div class="form-group"><label>Sobrenome: </label><div class="">{{ form.last_name }}</div></div><div class="form-group"><label>Email: </label><div class="">{{ form.email }}</div></div><div class="form-group"><label>Senha: </label><div class="">{{ form.password1 }}</div></div><div class="form-group"><label>Confirmação de Senha: </label><div class="">{{ form.password2 }}</div></div><div>{{ form2.as_p }}<button class="btn btn-info btn-fill pull-left" type="submit" style="background-color: #213f99; border-color: #213f99">Próximo</button></div></p>')
			document.getElementById('import/noimport').value = 'não'
		}
		else if (selectValor == 'sim'){
			$('#child').children('#não').remove();
			$('#child').append('<div id="sim"><p class="col-md-12" >Com este formulário você pode adicionar apenas estudantes ou estudantes e pais ao mesmo tempo. Para maiores detalhes faça o download do exemplo <a href="https://drive.google.com/uc?export=download&id=1Il0GTYo-vutzilAKSVsjAbhzazZHnlNZ">Neste Link</a>.<div class="w-100" ><input type="file" name="file" class="form-control" ></div> <div class="col-md-12" ><button class="btn btn-info btn-fill pull-left" type="submit" style="background-color: #213f99; border-color: #213f99">Próximo</button></div></p></div>');
			document.getElementById('import/noimport').value = 'sim'
		}
	}
</script>
{% endblock %}